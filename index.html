<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='utf-8' />
    <head>
        <title>GL4</title>
    </head>

    <body style='background: black;'>
        <canvas id='canvas' width=800 height=600 style='display: block; background: #333; margin-left: auto; margin-right: auto; cursor: none;'></canvas>

        <script type='text/javascript' src='../gl4/gl4.js'></script>
        <script type='text/javascript' src='../gl4/behaviors.js'></script>
        <script type='text/javascript' src='../gl4/conditions.js'></script>
        <script>
function game() {
    gl4.layer();
    var cursor = gl4.createImage('../art/cursor.png');
    moveTo(cursor, gl4.mouse);
    push(cursor, {angle: 0.01});

    var tank1 = gl4.createImage('../art/enemy.png', 'tank', {x: 100, y: 500});
    var tank2 = gl4.createImage('../art/enemy.png', 'tank', {x: 700, y: 500});
    tank1.tag('active tank');
    tank2.tag('inactive tank');
    glow('active tank');

    on(keyDown('up'), push('active tank', {angle: 0.03}));
    on(keyDown('down'), push('active tank', {angle: -0.03}));
    on(keyDown('left'), push('active tank', {x: -1}));
    on(keyDown('right'), push('active tank', {x: 1}));

    var TURN_TIME = 5;
    var timer = gl4.createText(TURN_TIME, [], {x: 780, y: 40});
    timer.alignment = 'righ';
    timer.font = '72px Impact';
    timer.color = '#66F';
    var strength = gl4.createText(0, [], {x: 20, y: 40});
    strength.alignment = 'left';
    strength.font = '72px Impact';
    strength.color = '#F00';
    var changeTurn = group(timer.set(TURN_TIME),
                           strength.set(0),
                           swapTags('active tank', 'inactive tank'));
    var shootBullet = function () {
        once(shoot('active tank', '../art/explosion.png', 'bullet', strength.value));
    }

    on(pulse(1, undefined, false), timer.subtract());
    on(timer.at(0), changeTurn);
    on(keyDown('space'), strength.add(0.2));
    on(up(keyUp('space'), true),
       [shootBullet,
        changeTurn]);

    push('bullet', {y: 0.1});
    fadeOut('bullet', 0.006);
    on(hit('bullet', 'active tank'), [destroy(MATCH_1), destroy(MATCH_2)]);
}

game();
//gl4.debug = true;
        </script>
    </body>
</html>
